{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.214.0"},"children":{"SpendMonitorStack":{"id":"SpendMonitorStack","path":"SpendMonitorStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.214.0"},"children":{"SpendMonitorLogGroup":{"id":"SpendMonitorLogGroup","path":"SpendMonitorStack/SpendMonitorLogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/SpendMonitorLogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":"/aws/lambda/spend-monitor-agent","retentionInDays":30}}}}},"SpendAlertTopic":{"id":"SpendAlertTopic","path":"SpendMonitorStack/SpendAlertTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/SpendAlertTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"AWS Spend Monitor Alerts","topicName":"aws-spend-alerts"}}}}},"DeviceTokenTable":{"id":"DeviceTokenTable","path":"SpendMonitorStack/DeviceTokenTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceTokenTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"deviceToken","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"deviceToken","keyType":"HASH"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"tableName":"spend-monitor-device-tokens"}}},"ScalingRole":{"id":"ScalingRole","path":"SpendMonitorStack/DeviceTokenTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}}}},"SpendMonitorAgent":{"id":"SpendMonitorAgent","path":"SpendMonitorStack/SpendMonitorAgent","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.214.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"SpendMonitorStack/SpendMonitorAgent/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"SpendMonitorStack/SpendMonitorAgent/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}},"Resource":{"id":"Resource","path":"SpendMonitorStack/SpendMonitorAgent/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"SpendMonitorStack/SpendMonitorAgent/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/SpendMonitorAgent/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ce:GetCostAndUsage","ce:GetDimensionValues","ce:GetReservationCoverage","ce:GetReservationPurchaseRecommendation","ce:GetReservationUtilization","ce:GetUsageReport","cloudwatch:PutMetricData"],"Effect":"Allow","Resource":"*"},{"Action":"sns:Publish","Effect":"Allow","Resource":{"Ref":"SpendAlertTopic7E2315E1"}},{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DeviceTokenTable5D54629B","Arn"]},{"Ref":"AWS::NoValue"}]}],"Version":"2012-10-17"},"policyName":"SpendMonitorAgentServiceRoleDefaultPolicyC1138BB7","roles":[{"Ref":"SpendMonitorAgentServiceRoleD4CAE3C2"}]}}}}}}},"Code":{"id":"Code","path":"SpendMonitorStack/SpendMonitorAgent/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.214.0"},"children":{"Stage":{"id":"Stage","path":"SpendMonitorStack/SpendMonitorAgent/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.214.0"}},"AssetBucket":{"id":"AssetBucket","path":"SpendMonitorStack/SpendMonitorAgent/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.214.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"SpendMonitorStack/SpendMonitorAgent/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710603110067-us-east-1","s3Key":"f7a5e7dc690c88db59fa93587f4e2a0d3d7df40adf2d4cf217b59a1d9b277693.zip"},"environment":{"variables":{"SNS_TOPIC_ARN":{"Ref":"SpendAlertTopic7E2315E1"},"SPEND_THRESHOLD":"10","CHECK_PERIOD_DAYS":"1","RETRY_ATTEMPTS":"3","MIN_SERVICE_COST":"1","IOS_PLATFORM_APP_ARN":"","IOS_BUNDLE_ID":"com.vinny.aws.spendmonitor","APNS_SANDBOX":"true","DEVICE_TOKEN_TABLE_NAME":{"Ref":"DeviceTokenTable5D54629B"}}},"handler":"index.handler","loggingConfig":{"logGroup":{"Ref":"SpendMonitorLogGroup367930B7"}},"memorySize":512,"role":{"Fn::GetAtt":["SpendMonitorAgentServiceRoleD4CAE3C2","Arn"]},"runtime":"nodejs18.x","timeout":300}}}}},"DeviceRegistrationFunction":{"id":"DeviceRegistrationFunction","path":"SpendMonitorStack/DeviceRegistrationFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.214.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"SpendMonitorStack/DeviceRegistrationFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"SpendMonitorStack/DeviceRegistrationFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}},"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"SpendMonitorStack/DeviceRegistrationFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DeviceTokenTable5D54629B","Arn"]},{"Ref":"AWS::NoValue"}]}],"Version":"2012-10-17"},"policyName":"DeviceRegistrationFunctionServiceRoleDefaultPolicy5DC0FEA4","roles":[{"Ref":"DeviceRegistrationFunctionServiceRole8BFAFB7E"}]}}}}}}},"Code":{"id":"Code","path":"SpendMonitorStack/DeviceRegistrationFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.214.0"},"children":{"Stage":{"id":"Stage","path":"SpendMonitorStack/DeviceRegistrationFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.214.0"}},"AssetBucket":{"id":"AssetBucket","path":"SpendMonitorStack/DeviceRegistrationFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.214.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710603110067-us-east-1","s3Key":"f7a5e7dc690c88db59fa93587f4e2a0d3d7df40adf2d4cf217b59a1d9b277693.zip"},"environment":{"variables":{"IOS_PLATFORM_APP_ARN":"","DEVICE_TOKEN_TABLE_NAME":{"Ref":"DeviceTokenTable5D54629B"},"IOS_BUNDLE_ID":"com.vinny.aws.spendmonitor"}},"handler":"device-registration-index.handler","memorySize":256,"role":{"Fn::GetAtt":["DeviceRegistrationFunctionServiceRole8BFAFB7E","Arn"]},"runtime":"nodejs18.x","timeout":30}}}}},"DeviceRegistrationApi":{"id":"DeviceRegistrationApi","path":"SpendMonitorStack/DeviceRegistrationApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"API for managing iOS device registrations for spend monitor notifications","name":"iOS Device Registration API"}}},"Deployment":{"id":"Deployment","path":"SpendMonitorStack/DeviceRegistrationApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"API for managing iOS device registrations for spend monitor notifications","restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}}}},"DeploymentStage.v1":{"id":"DeploymentStage.v1","path":"SpendMonitorStack/DeviceRegistrationApi/DeploymentStage.v1","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/DeploymentStage.v1/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"DeviceRegistrationApiDeployment2FDA60FAb2da9b50a297aee21fa01cf2dcdb8c0d"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":true,"loggingLevel":"INFO","metricsEnabled":true}],"restApiId":{"Ref":"DeviceRegistrationApi539944FE"},"stageName":"v1"}}}}},"Endpoint":{"id":"Endpoint","path":"SpendMonitorStack/DeviceRegistrationApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"Default":{"id":"Default","path":"SpendMonitorStack/DeviceRegistrationApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.214.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"SpendMonitorStack/DeviceRegistrationApi/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Fn::GetAtt":["DeviceRegistrationApi539944FE","RootResourceId"]},"restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}}}},"devices":{"id":"devices","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["DeviceRegistrationApi539944FE","RootResourceId"]},"pathPart":"devices","restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}},"OPTIONS":{"id":"OPTIONS","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"DeviceRegistrationApidevicesFCBC9A73"},"restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}}}},"POST":{"id":"POST","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/POST","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.214.0","metadata":[]},"children":{"ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.POST..devices":{"id":"ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.POST..devices","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/POST/ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.POST..devices","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:710603110067:",{"Ref":"DeviceRegistrationApi539944FE"},"/",{"Ref":"DeviceRegistrationApiDeploymentStagev1185A1A12"},"/POST/devices"]]}}}},"ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.POST..devices":{"id":"ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.POST..devices","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/POST/ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.POST..devices","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:710603110067:",{"Ref":"DeviceRegistrationApi539944FE"},"/test-invoke-stage/POST/devices"]]}}}},"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/POST/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":true,"authorizationType":"NONE","httpMethod":"POST","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST","requestTemplates":{"application/json":"{ \"statusCode\": \"200\" }"}},"requestModels":{"application/json":{"Ref":"DeviceRegistrationModelCFD74879"}},"requestValidatorId":{"Ref":"DeviceRegistrationValidator03E5AB79"},"resourceId":{"Ref":"DeviceRegistrationApidevicesFCBC9A73"},"restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}}}},"PUT":{"id":"PUT","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/PUT","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.214.0","metadata":[]},"children":{"ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.PUT..devices":{"id":"ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.PUT..devices","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/PUT/ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.PUT..devices","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:710603110067:",{"Ref":"DeviceRegistrationApi539944FE"},"/",{"Ref":"DeviceRegistrationApiDeploymentStagev1185A1A12"},"/PUT/devices"]]}}}},"ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.PUT..devices":{"id":"ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.PUT..devices","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/PUT/ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.PUT..devices","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:710603110067:",{"Ref":"DeviceRegistrationApi539944FE"},"/test-invoke-stage/PUT/devices"]]}}}},"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/PUT/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":true,"authorizationType":"NONE","httpMethod":"PUT","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST","requestTemplates":{"application/json":"{ \"statusCode\": \"200\" }"}},"resourceId":{"Ref":"DeviceRegistrationApidevicesFCBC9A73"},"restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}}}},"GET":{"id":"GET","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/GET","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.214.0","metadata":[]},"children":{"ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.GET..devices":{"id":"ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.GET..devices","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/GET/ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.GET..devices","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:710603110067:",{"Ref":"DeviceRegistrationApi539944FE"},"/",{"Ref":"DeviceRegistrationApiDeploymentStagev1185A1A12"},"/GET/devices"]]}}}},"ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.GET..devices":{"id":"ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.GET..devices","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/GET/ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.GET..devices","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:710603110067:",{"Ref":"DeviceRegistrationApi539944FE"},"/test-invoke-stage/GET/devices"]]}}}},"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/GET/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":true,"authorizationType":"NONE","httpMethod":"GET","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST","requestTemplates":{"application/json":"{ \"statusCode\": \"200\" }"}},"requestParameters":{"method.request.querystring.userId":true,"method.request.querystring.limit":false,"method.request.querystring.nextToken":false},"resourceId":{"Ref":"DeviceRegistrationApidevicesFCBC9A73"},"restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}}}},"{deviceToken}":{"id":"{deviceToken}","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/{deviceToken}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/{deviceToken}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Ref":"DeviceRegistrationApidevicesFCBC9A73"},"pathPart":"{deviceToken}","restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}},"OPTIONS":{"id":"OPTIONS","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/{deviceToken}/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/{deviceToken}/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"DeviceRegistrationApidevicesdeviceTokenBE9D1A74"},"restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}}}},"DELETE":{"id":"DELETE","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/{deviceToken}/DELETE","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.214.0","metadata":[]},"children":{"ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.DELETE..devices.{deviceToken}":{"id":"ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.DELETE..devices.{deviceToken}","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/{deviceToken}/DELETE/ApiPermission.SpendMonitorStackDeviceRegistrationApi4336D341.DELETE..devices.{deviceToken}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:710603110067:",{"Ref":"DeviceRegistrationApi539944FE"},"/",{"Ref":"DeviceRegistrationApiDeploymentStagev1185A1A12"},"/DELETE/devices/*"]]}}}},"ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.DELETE..devices.{deviceToken}":{"id":"ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.DELETE..devices.{deviceToken}","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/{deviceToken}/DELETE/ApiPermission.Test.SpendMonitorStackDeviceRegistrationApi4336D341.DELETE..devices.{deviceToken}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:710603110067:",{"Ref":"DeviceRegistrationApi539944FE"},"/test-invoke-stage/DELETE/devices/*"]]}}}},"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApi/Default/devices/{deviceToken}/DELETE/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":true,"authorizationType":"NONE","httpMethod":"DELETE","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["DeviceRegistrationFunction0D8ACE87","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST","requestTemplates":{"application/json":"{ \"statusCode\": \"200\" }"}},"requestParameters":{"method.request.path.deviceToken":true},"resourceId":{"Ref":"DeviceRegistrationApidevicesdeviceTokenBE9D1A74"},"restApiId":{"Ref":"DeviceRegistrationApi539944FE"}}}}}}}}}}}}}},"DeviceRegistrationValidator":{"id":"DeviceRegistrationValidator","path":"SpendMonitorStack/DeviceRegistrationValidator","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RequestValidator","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationValidator/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRequestValidator","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RequestValidator","aws:cdk:cloudformation:props":{"name":"device-registration-validator","restApiId":{"Ref":"DeviceRegistrationApi539944FE"},"validateRequestBody":true,"validateRequestParameters":false}}}}},"DeviceRegistrationModel":{"id":"DeviceRegistrationModel","path":"SpendMonitorStack/DeviceRegistrationModel","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Model","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationModel/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnModel","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Model","aws:cdk:cloudformation:props":{"contentType":"application/json","name":"DeviceRegistrationRequest","restApiId":{"Ref":"DeviceRegistrationApi539944FE"},"schema":{"type":"object","properties":{"deviceToken":{"type":"string","pattern":"^[0-9a-fA-F]{64}$"},"userId":{"type":"string"},"bundleId":{"type":"string"}},"required":["deviceToken"],"$schema":"http://json-schema.org/draft-04/schema#"}}}}}},"DeviceRegistrationApiKey":{"id":"DeviceRegistrationApiKey","path":"SpendMonitorStack/DeviceRegistrationApiKey","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ApiKey","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationApiKey/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnApiKey","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::ApiKey","aws:cdk:cloudformation:props":{"description":"API key for iOS device registration endpoints","enabled":true,"name":"spend-monitor-device-registration-key"}}}}},"DeviceRegistrationUsagePlan":{"id":"DeviceRegistrationUsagePlan","path":"SpendMonitorStack/DeviceRegistrationUsagePlan","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.UsagePlan","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/DeviceRegistrationUsagePlan/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnUsagePlan","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::UsagePlan","aws:cdk:cloudformation:props":{"apiStages":[{"apiId":{"Ref":"DeviceRegistrationApi539944FE"},"stage":{"Ref":"DeviceRegistrationApiDeploymentStagev1185A1A12"},"throttle":{}}],"description":"Usage plan for device registration API","quota":{"limit":10000,"period":"DAY"},"throttle":{"burstLimit":200,"rateLimit":100},"usagePlanName":"device-registration-usage-plan"}}},"UsagePlanKeyResource:SpendMonitorStackDeviceRegistrationApiKeyF035FA7E":{"id":"UsagePlanKeyResource:SpendMonitorStackDeviceRegistrationApiKeyF035FA7E","path":"SpendMonitorStack/DeviceRegistrationUsagePlan/UsagePlanKeyResource:SpendMonitorStackDeviceRegistrationApiKeyF035FA7E","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnUsagePlanKey","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::UsagePlanKey","aws:cdk:cloudformation:props":{"keyId":{"Ref":"DeviceRegistrationApiKeyE8DE2337"},"keyType":"API_KEY","usagePlanId":{"Ref":"DeviceRegistrationUsagePlanE5195C26"}}}}}},"SpendCheckSchedule":{"id":"SpendCheckSchedule","path":"SpendMonitorStack/SpendCheckSchedule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/SpendCheckSchedule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Daily AWS spend check at 9:00 UTC","scheduleExpression":"cron(0 9 * * ? *)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["SpendMonitorAgentBEC3B4B9","Arn"]}}]}}},"AllowEventRuleSpendMonitorStackSpendMonitorAgent55373C34":{"id":"AllowEventRuleSpendMonitorStackSpendMonitorAgent55373C34","path":"SpendMonitorStack/SpendCheckSchedule/AllowEventRuleSpendMonitorStackSpendMonitorAgent55373C34","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["SpendMonitorAgentBEC3B4B9","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["SpendCheckSchedule7DC10937","Arn"]}}}}}},"OperationalAlertTopic":{"id":"OperationalAlertTopic","path":"SpendMonitorStack/OperationalAlertTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/OperationalAlertTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"Spend Monitor Operational Alerts","topicName":"spend-monitor-ops-alerts"}}}}},"LambdaErrorAlarm":{"id":"LambdaErrorAlarm","path":"SpendMonitorStack/LambdaErrorAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/LambdaErrorAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for Lambda function errors in spend monitor","alarmName":"SpendMonitor-LambdaErrors","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"SpendMonitorAgentBEC3B4B9"}}],"evaluationPeriods":1,"metricName":"Errors","namespace":"AWS/Lambda","period":300,"statistic":"Sum","threshold":1,"treatMissingData":"notBreaching"}}}}},"LambdaDurationAlarm":{"id":"LambdaDurationAlarm","path":"SpendMonitorStack/LambdaDurationAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/LambdaDurationAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for Lambda function execution duration","alarmName":"SpendMonitor-LambdaDuration","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"SpendMonitorAgentBEC3B4B9"}}],"evaluationPeriods":2,"metricName":"Duration","namespace":"AWS/Lambda","period":300,"statistic":"Average","threshold":240000,"treatMissingData":"notBreaching"}}}}},"ExecutionFailureAlarm":{"id":"ExecutionFailureAlarm","path":"SpendMonitorStack/ExecutionFailureAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/ExecutionFailureAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for spend monitor execution failures","alarmName":"SpendMonitor-ExecutionFailures","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"Operation","value":"SpendMonitoring"}],"evaluationPeriods":1,"metricName":"ErrorRate","namespace":"SpendMonitor/Agent","period":300,"statistic":"Sum","threshold":1,"treatMissingData":"notBreaching"}}}}},"AlertDeliveryFailureAlarm":{"id":"AlertDeliveryFailureAlarm","path":"SpendMonitorStack/AlertDeliveryFailureAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/AlertDeliveryFailureAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for alert delivery failures","alarmName":"SpendMonitor-AlertDeliveryFailures","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"Status","value":"Failure"}],"evaluationPeriods":1,"metricName":"AlertDeliveryCount","namespace":"SpendMonitor/Agent","period":300,"statistic":"Sum","threshold":1,"treatMissingData":"notBreaching"}}}}},"iOSNotificationFailureAlarm":{"id":"iOSNotificationFailureAlarm","path":"SpendMonitorStack/iOSNotificationFailureAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/iOSNotificationFailureAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for iOS push notification delivery failures","alarmName":"SpendMonitor-iOSNotificationFailures","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"Status","value":"Failure"}],"evaluationPeriods":1,"metricName":"iOSNotificationCount","namespace":"SpendMonitor/iOS","period":300,"statistic":"Sum","threshold":1,"treatMissingData":"notBreaching"}}}}},"iOSInvalidTokenAlarm":{"id":"iOSInvalidTokenAlarm","path":"SpendMonitorStack/iOSInvalidTokenAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/iOSInvalidTokenAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for high rate of invalid iOS device tokens","alarmName":"SpendMonitor-iOSInvalidTokens","comparisonOperator":"GreaterThanOrEqualToThreshold","evaluationPeriods":1,"metricName":"iOSInvalidTokens","namespace":"SpendMonitor/iOS","period":900,"statistic":"Sum","threshold":5,"treatMissingData":"notBreaching"}}}}},"APNSCertificateHealthAlarm":{"id":"APNSCertificateHealthAlarm","path":"SpendMonitorStack/APNSCertificateHealthAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/APNSCertificateHealthAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for APNS certificate validation failures","alarmName":"SpendMonitor-APNSCertificateHealth","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"Operation","value":"APNSCertificateValidation"},{"name":"Status","value":"Failure"}],"evaluationPeriods":2,"metricName":"ExecutionCount","namespace":"SpendMonitor/iOS","period":300,"statistic":"Sum","threshold":1,"treatMissingData":"notBreaching"}}}}},"APNSCertificateExpirationWarningAlarm":{"id":"APNSCertificateExpirationWarningAlarm","path":"SpendMonitorStack/APNSCertificateExpirationWarningAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/APNSCertificateExpirationWarningAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Warning alarm for APNS certificate expiring within 30 days","alarmName":"SpendMonitor-APNSCertificateExpirationWarning","comparisonOperator":"LessThanThreshold","evaluationPeriods":1,"metricName":"APNSCertificateDaysUntilExpiration","namespace":"SpendMonitor/iOS","period":21600,"statistic":"Minimum","threshold":30,"treatMissingData":"notBreaching"}}}}},"APNSCertificateExpirationCriticalAlarm":{"id":"APNSCertificateExpirationCriticalAlarm","path":"SpendMonitorStack/APNSCertificateExpirationCriticalAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/APNSCertificateExpirationCriticalAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Critical alarm for APNS certificate expiring within 7 days","alarmName":"SpendMonitor-APNSCertificateExpirationCritical","comparisonOperator":"LessThanThreshold","evaluationPeriods":1,"metricName":"APNSCertificateDaysUntilExpiration","namespace":"SpendMonitor/iOS","period":3600,"statistic":"Minimum","threshold":7,"treatMissingData":"notBreaching"}}}}},"iOSFallbackUsageAlarm":{"id":"iOSFallbackUsageAlarm","path":"SpendMonitorStack/iOSFallbackUsageAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/iOSFallbackUsageAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for high iOS notification fallback usage rate","alarmName":"SpendMonitor-iOSFallbackUsage","comparisonOperator":"GreaterThanOrEqualToThreshold","evaluationPeriods":1,"metricName":"iOSFallbackUsed","namespace":"SpendMonitor/iOS","period":900,"statistic":"Sum","threshold":3,"treatMissingData":"notBreaching"}}}}},"iOSRegistrationFailureAlarm":{"id":"iOSRegistrationFailureAlarm","path":"SpendMonitorStack/iOSRegistrationFailureAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/iOSRegistrationFailureAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"OperationalAlertTopicB3F33E16"}],"alarmDescription":"Alarm for iOS device registration failures","alarmName":"SpendMonitor-iOSRegistrationFailures","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"Operation","value":"RegisterDevice"},{"name":"Status","value":"Failure"}],"evaluationPeriods":1,"metricName":"ExecutionCount","namespace":"SpendMonitor/iOS","period":300,"statistic":"Sum","threshold":3,"treatMissingData":"notBreaching"}}}}},"SpendMonitorDashboard":{"id":"SpendMonitorDashboard","path":"SpendMonitorStack/SpendMonitorDashboard","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Dashboard","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"SpendMonitorStack/SpendMonitorDashboard/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnDashboard","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Dashboard","aws:cdk:cloudformation:props":{"dashboardBody":{"Fn::Join":["",["{\"widgets\":[{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Lambda Function Metrics\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/Lambda\",\"Invocations\",\"FunctionName\",\"",{"Ref":"SpendMonitorAgentBEC3B4B9"},"\",{\"stat\":\"Sum\"}],[\"AWS/Lambda\",\"Errors\",\"FunctionName\",\"",{"Ref":"SpendMonitorAgentBEC3B4B9"},"\",{\"stat\":\"Sum\"}],[\"AWS/Lambda\",\"Duration\",\"FunctionName\",\"",{"Ref":"SpendMonitorAgentBEC3B4B9"},"\",{\"yAxis\":\"right\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":6,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Spend Monitoring Metrics\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"SpendMonitor/Agent\",\"CurrentSpend\",{\"period\":3600}],[\"SpendMonitor/Agent\",\"ProjectedMonthlySpend\",{\"period\":3600}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":12,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Alert Delivery Metrics\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"SpendMonitor/Agent\",\"AlertDeliveryCount\",\"Status\",\"Success\",{\"stat\":\"Sum\"}],[\"SpendMonitor/Agent\",\"AlertDeliveryCount\",\"Status\",\"Failure\",{\"stat\":\"Sum\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":18,\"properties\":{\"view\":\"timeSeries\",\"title\":\"iOS Notification Metrics\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"SpendMonitor/iOS\",\"iOSNotificationCount\",\"Status\",\"Success\",{\"stat\":\"Sum\"}],[\"SpendMonitor/iOS\",\"iOSNotificationCount\",\"Status\",\"Failure\",{\"stat\":\"Sum\"}],[\"SpendMonitor/iOS\",\"iOSInvalidTokens\",{\"period\":900,\"stat\":\"Sum\",\"yAxis\":\"right\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":24,\"properties\":{\"view\":\"timeSeries\",\"title\":\"iOS System Health Metrics\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"SpendMonitor/iOS\",\"ExecutionCount\",\"Operation\",\"APNSCertificateValidation\",\"Status\",\"Success\",{\"period\":3600,\"stat\":\"Sum\"}],[\"SpendMonitor/iOS\",\"ExecutionCount\",\"Operation\",\"APNSCertificateValidation\",\"Status\",\"Failure\",{\"period\":3600,\"stat\":\"Sum\"}],[\"SpendMonitor/iOS\",\"iOSDeviceCount\",{\"period\":3600,\"yAxis\":\"right\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":30,\"properties\":{\"view\":\"timeSeries\",\"title\":\"APNS Certificate Health\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"SpendMonitor/iOS\",\"APNSCertificateDaysUntilExpiration\",{\"period\":21600,\"stat\":\"Minimum\"}],[\"SpendMonitor/iOS\",\"APNSCertificateValid\",{\"period\":3600}],[\"SpendMonitor/iOS\",\"APNSCertificateWarnings\",{\"period\":3600,\"stat\":\"Sum\",\"yAxis\":\"right\"}],[\"SpendMonitor/iOS\",\"APNSCertificateErrors\",{\"period\":3600,\"stat\":\"Sum\",\"yAxis\":\"right\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":36,\"properties\":{\"view\":\"timeSeries\",\"title\":\"iOS Fallback and Error Recovery\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"SpendMonitor/iOS\",\"iOSFallbackUsed\",\"Status\",\"Success\",{\"period\":900,\"stat\":\"Sum\"}],[\"SpendMonitor/iOS\",\"iOSFallbackUsed\",\"Status\",\"Failure\",{\"period\":900,\"stat\":\"Sum\"}],[\"SpendMonitor/iOS\",\"iOSPayloadSize\",{\"period\":900,\"yAxis\":\"right\"}],[\"SpendMonitor/iOS\",\"iOSNotificationDeliveryTime\",{\"period\":900,\"yAxis\":\"right\"}]],\"yAxis\":{}}}]}"]]},"dashboardName":"SpendMonitorAgent"}}}}},"SNSTopicArn":{"id":"SNSTopicArn","path":"SpendMonitorStack/SNSTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"AgentFunctionName":{"id":"AgentFunctionName","path":"SpendMonitorStack/AgentFunctionName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"DeviceTokenTableName":{"id":"DeviceTokenTableName","path":"SpendMonitorStack/DeviceTokenTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"LogGroupName":{"id":"LogGroupName","path":"SpendMonitorStack/LogGroupName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"OperationalAlertTopicArn":{"id":"OperationalAlertTopicArn","path":"SpendMonitorStack/OperationalAlertTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"DashboardURL":{"id":"DashboardURL","path":"SpendMonitorStack/DashboardURL","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"DeviceRegistrationApiUrl":{"id":"DeviceRegistrationApiUrl","path":"SpendMonitorStack/DeviceRegistrationApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"DeviceRegistrationApiKeyId":{"id":"DeviceRegistrationApiKeyId","path":"SpendMonitorStack/DeviceRegistrationApiKeyId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"DeviceRegistrationFunctionName":{"id":"DeviceRegistrationFunctionName","path":"SpendMonitorStack/DeviceRegistrationFunctionName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"SpendMonitorStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"SpendMonitorStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.214.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"SpendMonitorStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.214.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"SpendMonitorStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.214.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}